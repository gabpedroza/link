<!DOCTYPE html>
<html>
<head>
    <title>Redirecting...</title>
    <script>
        fetch('/link/links.json') // Make sure this path matches your repo name
            .then(response => response.json())
            .then(data => {
                // 1. Get the path and convert it to LOWERCASE
                // This turns "/s/Twitter" into "twitter"
                const rawPath = window.location.pathname.replace(/\/s\//g, "");
                const cleanPath = rawPath.replace(/\/$/, "").toLowerCase();

                // 2. Create a version of your database where all keys are lowercase
                const links = {};
                for (let key in data) {
                    links[key.toLowerCase()] = data[key];
                }

                // 3. Look up the link
                const target = links[cleanPath];

                if (target) {
                    window.location.replace(target); // .replace is better for back-button behavior
                } else {
                    document.body.innerHTML = `Link "${cleanPath}" not found. <a href="/link/links.json">View all links</a>`;
                }
            })
            .catch(err => {
                document.body.innerHTML = "Error loading links.";
            });
    </script>
</head>
<body>
    <p>Redirecting you...</p>
</body>
</html>
